const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/unitConversion-DUxUAKZf.js","assets/index-jfgqsXUF.js","assets/vendor-0HVaVRtn.js","assets/index-CDFczaSZ.css"])))=>i.map(i=>d[i]);
import{bk as Y,P as M,f_ as w,aY as y,f$ as v,cm as F,bN as C,_ as G,z as I,bO as b,cn as Q,C as k}from"./index-jfgqsXUF.js";import{F as c,ah as g,Z as z,u as h,a1 as B,a0 as V,y as _,g as J,A as U,B as R,ai as q,aj as E,ak as X,al as Z,b as P,am as T,J as x,an as $,ao as nn,ap as en,V as H,C as L,K as j}from"./arcade-C-F8JS9C.js";import{a as o,r as s}from"./unitConversion-DUxUAKZf.js";import{o as O}from"./TimeOnly-C39e4_MX.js";import{l as K}from"./portalUtils-B3W6-XKJ.js";import{a as f}from"./operatorsWorkerConnection-CAH0JiVQ.js";import"./vendor-0HVaVRtn.js";import"./ImmutableArray-BPVd6ESQ.js";import"./shared-53eTJEOP.js";import"./number-C6iAXBd1.js";import"./featureConversionUtils-BAN7iPzO.js";import"./OptimizedFeature-CQnDPIV2.js";import"./memoryEstimations-BucWCUN2.js";import"./OptimizedGeometry-aBFBEGLw.js";import"./OptimizedFeatureSet-Blu9Ckm7.js";import"./WhereClause-mqdqH7zu.js";async function W(a,e,t){if(!Y?.findCredential(a.restUrl))return null;if(a.loadStatus==="loaded"&&e===""&&a.user?.sourceJSON&&t===!1)return a.user.sourceJSON;const u={responseType:"json",query:{f:"json"}};if(t&&(u.query.returnUserLicenseTypeExtensions=!0),e===""){const r=await M(a.restUrl+"/community/self",u);if(r.data){const i=r.data;if(i?.username)return i}return null}const n=await M(a.restUrl+"/community/users/"+e,u);if(n.data){const r=n.data;return r.error?null:r}return null}function p(a){if(a==null)return a;switch(typeof a){case"string":case"number":return a;default:throw new o(null,s.InvalidParameter,null)}}function Sn(a){a.mode==="async"&&(a.functions.disjoint=function(e,t){return a.standardFunctionAsync(e,t,(l,u,n)=>(n=c(n),g(n,e,t),n[0]===null||n[1]===null||f("disjoint",[n[0].toJSON(),n[1].toJSON()])))},a.functions.intersects=function(e,t){return a.standardFunctionAsync(e,t,(l,u,n)=>(n=c(n),g(n,e,t),n[0]!==null&&n[1]!==null&&f("intersects",[n[0].toJSON(),n[1].toJSON()])))},a.functions.touches=function(e,t){return a.standardFunctionAsync(e,t,(l,u,n)=>(n=c(n),g(n,e,t),n[0]!==null&&n[1]!==null&&f("touches",[n[0].toJSON(),n[1].toJSON()])))},a.functions.crosses=function(e,t){return a.standardFunctionAsync(e,t,(l,u,n)=>(n=c(n),g(n,e,t),n[0]!==null&&n[1]!==null&&f("crosses",[n[0].toJSON(),n[1].toJSON()])))},a.functions.within=function(e,t){return a.standardFunctionAsync(e,t,(l,u,n)=>(n=c(n),g(n,e,t),n[0]!==null&&n[1]!==null&&f("within",[n[0].toJSON(),n[1].toJSON()])))},a.functions.contains=function(e,t){return a.standardFunctionAsync(e,t,(l,u,n)=>(n=c(n),g(n,e,t),n[0]!==null&&n[1]!==null&&f("contains",[n[0].toJSON(),n[1].toJSON()])))},a.functions.overlaps=function(e,t){return a.standardFunctionAsync(e,t,(l,u,n)=>(n=c(n),g(n,e,t),n[0]!==null&&n[1]!==null&&f("overlaps",[n[0].toJSON(),n[1].toJSON()])))},a.functions.equals=function(e,t){return a.standardFunctionAsync(e,t,(l,u,n)=>(h(n,2,2,e,t),n[0]===n[1]||(n[0]instanceof w&&n[1]instanceof w?f("equals",[n[0].toJSON(),n[1].toJSON()]):(z(n[0])&&z(n[1])||!!(B(n[0])&&B(n[1])||V(n[0])&&V(n[1])))&&n[0].equals(n[1]))))},a.functions.relate=function(e,t){return a.standardFunctionAsync(e,t,(l,u,n)=>{if(n=c(n),h(n,3,3,e,t),n[0]instanceof w&&n[1]instanceof w)return f("relate",[n[0].toJSON(),n[1].toJSON(),_(n[2])]);if(n[0]instanceof w&&n[1]===null||n[1]instanceof w&&n[0]===null||n[0]===null&&n[1]===null)return!1;throw new o(e,s.InvalidParameter,t)})},a.functions.intersection=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>(n=c(n),g(n,e,t),n[0]===null||n[1]===null?null:y(await f("intersection",[n[0].toJSON(),n[1].toJSON()]))))},a.functions.union=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{if((n=c(n)).length===0)throw new o(e,s.WrongNumberOfParameters,t);const r=[];if(n.length===1)if(v(n[0])){for(const i of c(n[0]))if(i!==null){if(!(i instanceof w))throw new o(e,s.InvalidParameter,t);r.push(i.toJSON())}}else{if(!J(n[0])){if(n[0]instanceof w)return U(O(n[0]),e.spatialReference);if(n[0]===null)return null;throw new o(e,s.InvalidParameter,t)}for(const i of c(n[0].toArray()))if(i!==null){if(!(i instanceof w))throw new o(e,s.InvalidParameter,t);r.push(i.toJSON())}}else for(const i of n)if(i!==null){if(!(i instanceof w))throw new o(e,s.InvalidParameter,t);r.push(i.toJSON())}return r.length===0?null:y(await f("union",[r]))})},a.functions.difference=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>(n=c(n),g(n,e,t),n[0]===null?null:n[1]===null?O(n[0]):y(await f("difference",[n[0].toJSON(),n[1].toJSON()]))))},a.functions.symmetricdifference=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>(n=c(n),g(n,e,t),n[0]===null&&n[1]===null?null:n[0]===null?O(n[1]):n[1]===null?O(n[0]):y(await f("symmetricDifference",[n[0].toJSON(),n[1].toJSON()]))))},a.functions.clip=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{if(n=c(n),h(n,2,2,e,t),!(n[1]instanceof F)&&n[1]!==null)throw new o(e,s.InvalidParameter,t);if(n[0]===null)return null;if(!(n[0]instanceof w))throw new o(e,s.InvalidParameter,t);return n[1]===null?null:y(await f("clip",[n[0].toJSON(),n[1].toJSON()]))})},a.functions.cut=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{if(n=c(n),h(n,2,2,e,t),!(n[1]instanceof C)&&n[1]!==null)throw new o(e,s.InvalidParameter,t);if(n[0]===null)return[];if(!(n[0]instanceof w))throw new o(e,s.InvalidParameter,t);return n[1]===null?[O(n[0])]:(await f("cut",[n[0].toJSON(),n[1].toJSON()])).map(r=>y(r))})},a.functions.area=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{if(h(n,1,2,e,t),n=c(n),R(n[0])){const i=await n[0].sumArea(p(n[1]),!1,e.abortSignal);if(e.abortSignal.aborted)throw new o(e,s.Cancelled,t);return i}let r=n[0];if((v(r)||J(r))&&(r=q(n[0],e.spatialReference)),r===null)return 0;if(!(r instanceof w))throw new o(e,s.InvalidParameter,t);return f("area",[r.toJSON(),p(n[1])])})},a.functions.areageodetic=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{if(h(n,1,2,e,t),n=c(n),R(n[0])){const i=await n[0].sumArea(p(n[1]),!0,e.abortSignal);if(e.abortSignal.aborted)throw new o(e,s.Cancelled,t);return i}let r=n[0];if((v(n[0])||J(n[0]))&&(r=q(n[0],e.spatialReference)),r===null)return 0;if(!(r instanceof w))throw new o(e,s.InvalidParameter,t);return f("geodeticArea",[r.toJSON(),p(n[1])])})},a.functions.length=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{if(h(n,1,2,e,t),n=c(n),R(n[0])){const i=await n[0].sumLength(p(n[1]),!1,e.abortSignal);if(e.abortSignal.aborted)throw new o(e,s.Cancelled,t);return i}let r=n[0];if((v(n[0])||J(n[0]))&&(r=E(n[0],e.spatialReference)),r===null)return 0;if(!(r instanceof w))throw new o(e,s.InvalidParameter,t);return f("length",[r.toJSON(),p(n[1])])})},a.functions.length3d=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{if(h(n,1,2,e,t),(n=c(n))[0]===null)return 0;let r=n[0];if((v(n[0])||J(n[0]))&&(r=E(n[0],e.spatialReference)),r===null)return 0;if(!(r instanceof w))throw new o(e,s.InvalidParameter,t);if(r.hasZ===!0){const{convertFromSpatialReferenceUnit:i,toLengthUnit:m}=await G(()=>import("./unitConversion-DUxUAKZf.js").then(N=>N.e),__vite__mapDeps([0,1,2,3])),d=X(r);return i(r.spatialReference,m(n[1]),d)}return f("length",[r.toJSON(),p(n[1])])})},a.functions.lengthgeodetic=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{if(h(n,1,2,e,t),n=c(n),R(n[0])){const i=await n[0].sumLength(p(n[1]),!0,e.abortSignal);if(e.abortSignal.aborted)throw new o(e,s.Cancelled,t);return i}let r=n[0];if((v(n[0])||J(n[0]))&&(r=E(n[0],e.spatialReference)),r===null)return 0;if(!(r instanceof w))throw new o(e,s.InvalidParameter,t);return f("geodeticLength",[r.toJSON(),p(n[1])])})},a.functions.distance=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{n=c(n),h(n,2,3,e,t);let r=n[0];if((v(n[0])||J(n[0]))&&(r=Z(n[0],e.spatialReference)),!(r instanceof w))throw new o(e,s.InvalidParameter,t);let i=n[1];if((v(n[1])||J(n[1]))&&(i=Z(n[1],e.spatialReference)),!(i instanceof w))throw new o(e,s.InvalidParameter,t);return f("distance",[r.toJSON(),i.toJSON(),p(n[2])])})},a.functions.distancegeodetic=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{n=c(n),h(n,2,3,e,t);const r=n[0];if(!(r instanceof I))throw new o(e,s.InvalidParameter,t);const i=n[1];if(!(i instanceof I))throw new o(e,s.InvalidParameter,t);const m=new C({paths:[],spatialReference:r.spatialReference});return m.addPath([r,i]),f("geodeticLength",[m.toJSON(),p(n[2])])})},a.functions.densify=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{if(n=c(n),h(n,2,3,e,t),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(e,s.InvalidParameter,t);const r=P(n[1]);if(isNaN(r))throw new o(e,s.InvalidParameter,t);if(r<=0)throw new o(e,s.InvalidParameter,t);switch(n[0].type){case"polygon":case"polyline":case"extent":return y(await f("densify",[n[0].toJSON(),r,p(n[2])]));default:return n[0]}})},a.functions.densifygeodetic=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{if(n=c(n),h(n,2,3,e,t),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(e,s.InvalidParameter,t);const r=P(n[1]);if(isNaN(r))throw new o(e,s.InvalidParameter,t);if(r<=0)throw new o(e,s.InvalidParameter,t);switch(n[0].type){case"polygon":case"polyline":case"extent":return y(await f("geodeticDensify",[n[0].toJSON(),r,p(n[2])]));default:return n[0]}})},a.functions.generalize=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{if(n=c(n),h(n,2,4,e,t),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(e,s.InvalidParameter,t);const r=P(n[1]);if(isNaN(r))throw new o(e,s.InvalidParameter,t);const i=T(x(n[2],!0));return y(await f("generalize",[n[0].toJSON(),r,p(n[3]),{removeDegenerateParts:i}]))})},a.functions.buffer=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{if(n=c(n),h(n,2,3,e,t),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(e,s.InvalidParameter,t);const r=P(n[1]);if(isNaN(r))throw new o(e,s.InvalidParameter,t);return r===0?O(n[0]):y(await f("buffer",[n[0].toJSON(),r,p(n[2])]))})},a.functions.buffergeodetic=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{if(n=c(n),h(n,2,3,e,t),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(e,s.InvalidParameter,t);const r=P(n[1]);if(isNaN(r))throw new o(e,s.InvalidParameter,t);return r===0?O(n[0]):y(await f("geodesicBuffer",[n[0].toJSON(),r,p(n[2])]))})},a.functions.offset=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{if(n=c(n),h(n,2,6,e,t),n[0]===null)return null;if(!(n[0]instanceof b||n[0]instanceof C))throw new o(e,s.InvalidParameter,t);const r=P(n[1]);if(isNaN(r))throw new o(e,s.InvalidParameter,t);const i=_(n[3]??"round").toLowerCase();let m;switch(i){case"round":case"bevel":case"miter":case"square":m=i;break;default:m="round"}const d=P(x(n[4],10));if(isNaN(d))throw new o(e,s.InvalidParameter,t);const N=P(x(n[5],0));if(isNaN(N))throw new o(e,s.InvalidParameter,t);return y(await f("offset",[n[0].toJSON(),r,p(n[2]),{joins:m,miterLimit:d,flattenError:N}]))})},a.functions.rotate=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{if(n=c(n),h(n,2,3,e,t),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(e,s.InvalidParameter,t);const r=n[0]instanceof F?b.fromExtent(n[0]):n[0],i=P(n[1]);if(isNaN(i))throw new o(e,s.InvalidParameter,t);const m=x(n[2],null);if(m===null){const d=r.type==="point"?r:r.extent?.center;return y(await f("rotate",[r.toJSON(),i,d?.x,d?.y]))}if(m instanceof I)return y(await f("rotate",[r.toJSON(),i,m.x,m.y]));throw new o(e,s.InvalidParameter,t)})},a.functions.centroid=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{if(n=c(n),h(n,1,2,e,t),n[0]===null)return null;const r=_(n[1]??"geometric").toLowerCase();if(r!=="geometric"&&r!=="labelpoint")throw new o(e,s.InvalidParameter,t);let i=n[0];if((v(n[0])||J(n[0]))&&(i=r==="geometric"?Z(n[0],e.spatialReference):q(n[0],e.spatialReference),i===null))return null;if(!(i instanceof w))throw new o(e,s.InvalidParameter,t);return y(r==="geometric"?await f("centroid",[i.toJSON()]):await f("labelPoint",[i.toJSON()]))})},a.functions.measuretocoordinate=function(e,t){return a.standardFunctionAsync(e,t,$)},a.functions.pointtocoordinate=function(e,t){return a.standardFunctionAsync(e,t,nn)},a.functions.distancetocoordinate=function(e,t){return a.standardFunctionAsync(e,t,en)},a.functions.multiparttosinglepart=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{if(n=c(n),h(n,1,1,e,t),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(e,s.InvalidParameter,t);if(n[0]instanceof I)return[U(O(n[0]),e.spatialReference)];if(n[0]instanceof F)return[U(O(n[0]),e.spatialReference)];const r=y(await f("simplify",[n[0].toJSON()]));if(r instanceof b){const i=[],m=[];for(let d=0;d<r.rings.length;d++)if(r.isClockwise(r.rings[d])){const N=y({rings:[r.rings[d]],hasZ:r.hasZ===!0,hasM:r.hasM===!0,spatialReference:r.spatialReference.toJSON()});i.push(N)}else m.push({ring:r.rings[d],pt:r.getPoint(d,0)});for(let d=0;d<m.length;d++)for(let N=0;N<i.length;N++)if(i[N].contains(m[d].pt)){i[N].addRing(m[d].ring);break}return i}if(r instanceof C){const i=[];for(let m=0;m<r.paths.length;m++){const d=y({paths:[r.paths[m]],hasZ:r.hasZ===!0,hasM:r.hasM===!0,spatialReference:r.spatialReference.toJSON()});i.push(d)}return i}if(n[0]instanceof Q){const i=[],m=U(O(n[0]),e.spatialReference);for(let d=0;d<m.points.length;d++)i.push(m.getPoint(d));return i}return null})},a.functions.issimple=function(e,t){return a.standardFunctionAsync(e,t,(l,u,n)=>{if(n=c(n),h(n,1,1,e,t),n[0]===null)return!0;if(!(n[0]instanceof w))throw new o(e,s.InvalidParameter,t);return f("isSimple",[n[0].toJSON()])})},a.functions.simplify=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{if(n=c(n),h(n,1,1,e,t),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(e,s.InvalidParameter,t);return y(await f("simplify",[n[0].toJSON()]))})},a.functions.convexhull=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{if(n=c(n),h(n,1,1,e,t),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(e,s.InvalidParameter,t);return y(await f("convexHull",[n[0].toJSON()]))})},a.functions.getuser=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{h(n,0,2,e,t);let r=x(n[1],""),i=r===!0;if(r=r===!0||r===!1?"":_(r),n.length===0||n[0]instanceof H){let d;d=e.services?.portal?e.services.portal:k.getDefault(),n.length>0&&(d=K(n[0],d));const N=await W(d,r,i);if(N){const A=JSON.parse(JSON.stringify(N));for(const S of["lastLogin","created","modified"])A[S]!==void 0&&A[S]!==null&&(A[S]=new Date(A[S]));return L.convertObjectToArcadeDictionary(A,j(e))}return null}let m=null;if(R(n[0])&&(m=n[0]),m){if(i=!1,r)return null;await m.load();const d=await m.getOwningSystemUrl();if(!d){if(!r){const S=await m.getIdentityUser();return S?L.convertObjectToArcadeDictionary({username:S},j(e)):null}return null}let N;N=e.services?.portal?e.services.portal:k.getDefault(),N=K(new H(d),N);const A=await W(N,r,i);if(A){const S=JSON.parse(JSON.stringify(A));for(const D of["lastLogin","created","modified"])S[D]!==void 0&&S[D]!==null&&(S[D]=new Date(S[D]));return L.convertObjectToArcadeDictionary(S,j(e))}return null}throw new o(e,s.InvalidParameter,t)})},a.functions.nearestcoordinate=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{if(n=c(n),h(n,2,2,e,t),!(n[0]instanceof w||n[0]===null))throw new o(e,s.InvalidParameter,t);if(!(n[1]instanceof I||n[1]===null))throw new o(e,s.InvalidParameter,t);if(n[0]===null||n[1]===null)return null;const r=n[0]instanceof F?b.fromExtent(n[0]):n[0],i=await f("getNearestCoordinate",[r.toJSON(),n[1].toJSON(),{calculateLeftRightSide:!0}]);return i===null?null:L.convertObjectToArcadeDictionary({coordinate:y(i.coordinate),distance:i.distance,sideOfLine:i.distance===0?"straddle":i.rightSide?"right":"left"},j(e),!1,!0)})},a.functions.nearestvertex=function(e,t){return a.standardFunctionAsync(e,t,async(l,u,n)=>{if(n=c(n),h(n,2,2,e,t),!(n[0]instanceof w||n[0]===null))throw new o(e,s.InvalidParameter,t);if(!(n[1]instanceof I||n[1]===null))throw new o(e,s.InvalidParameter,t);if(n[0]===null||n[1]===null)return null;const r=n[0]instanceof F?b.fromExtent(n[0]):n[0],i=await f("getNearestVertex",[r.toJSON(),n[1].toJSON()]);return i===null?null:L.convertObjectToArcadeDictionary({coordinate:y(i.coordinate),distance:i.distance,sideOfLine:i.distance===0?"straddle":i.rightSide?"right":"left"},j(e),!1,!0)})})}export{Sn as registerFunctions};
